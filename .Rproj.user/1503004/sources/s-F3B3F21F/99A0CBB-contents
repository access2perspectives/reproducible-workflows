---
title: "RespPCT trial"
author: "Brendan A. Palmer"
date: "15th October 2018"
output: word_document 
---

# RespPCT
### Researcher: Frank O'Riordan
### Role/Organisation: Antimicrobial Pharmacist, Mercy University Hospital Cork

## Background:

Between 20-50% of antimicrobial prescribing in acute hospitals is has been classified as either unnecessary or inappropriate. Procalcitonin (PCT) is a biomarker that is elevated in bacterial infections to detectable levels in bacterial infections yet remains low in viral infections. It has the potential to inform clinical decisions on antimicrobial initiation and/or discontinuation and stewardship programmes. This study will investigate the feasibility of introducing PCT testing in MUH to support the stewardship programme and improve the prescribing of antimicrobials.

## Raw data
The date was provided in the form of a Microsoft Access file containing seven data tables, four of which contained study data. "General information2" contained PIDs in the form of MRN and patient initials. These were permanently deleted from all files immediately upon receipt.

Data files:
abx - Antibiotic prescription details
pt_info - patient basic information, co-morbidities, length of stay, clinical presentation etc
monitoring - information on patient condition during admission
pct - PCT readings and treatment recommendations

```{r Data import and cleaning, include = FALSE}

library(sjPlot)
library(effsize)
library(lme4)
library(broom)
library(purrr)
library(pander)
library(knitr)
library(gridExtra)
library(tidyverse)
panderOptions('round', 3)
panderOptions('keep.trailing.zeros', TRUE)
```

```{r Plots, include = FALSE}

source("scripts/figures.R")

# This reads in the pre-formatted ggplot outputs

```

## Data overview
### General information
```{r summary info, include = FALSE}
action <- pct %>%
  group_by(algorithm.recommendation, action.of.team) %>%
   summarise(n = n())

not_follow <- action %>%
  filter(algorithm.recommendation == "Antibiotic therapy discouraged")
```                                    

`r kable(table(pt_info$study.group), col.names = c("Study arm", "Number"))`

### PCT group
`r kable(action, col.names = c("Algorithm recommendation", "Action of team", "Count"))`

`r action$n[action$algorithm.recommendation == "Antibiotic therapy strongly discouraged" & action$action.of.team == "Did not comply"]` times antibiotic therapy strongly discouraged, the clinical team did not follow the recommendation. Of these, just `r not_follow$n[not_follow$rational.for.action == "Clinical decision"]` were due to a clinical decision. The remaining instances were due to over-riding criteria being met. 

When clinicans were discouraged from giving antibiotics (as opposed to "strongly discouraged"), the advice was never followed. This suggests that the action to "discourage" antibiotic use is redundant. 

## Table 1

## Table 2

## Table 3


![Fig. 1. Recruitment to each study arm over time](plots/01-arm-recruitment_over_time.png)


![Fig. 2. Density plots](plots/08_Overview-primary-outcomes.png){width=100%}


![Fig. 3. Main variable overview.](plots/09_Overview-primary-outcomes-combined.png)



![Fig. 4. Length of stay (days)](plots/02_length-of-stay-barplot.png)



![Fig. 5. DDD versus DOT](plots/07_DDD-vs-DOT.png)



## Analysis outputs
```{r Data analysis, include = FALSE}
abx_distinct_wx <- abx %>%
  distinct(patient.id, .keep_all = TRUE) %>%
  select(study.group, total.ddd.for.patient, 
         total.days.of.therapy.in.patient, total.duration.days.of.all.inpatient.abx) %>%
  filter(study.group != "control")

pt_info_wx <- pt_info %>%
  filter(study.group != "control")
```

Initial visualisation of the data suggested the non-parametric Wilxon Rank Sum test would be most appropriate to apply. Initially the analysis was performed using just the PCT arm and the Respiratory arms.

#### Total defined daily doses (DDD) per patient
`r pander(wilcox.test(total.ddd.for.patient ~ study.group, data = abx_distinct_wx))`

#### Total days of therapy in patient
`r pander(wilcox.test(total.days.of.therapy.in.patient ~ study.group, data = abx_distinct_wx))`

#### Total duration of days for all inpatient antibiotics
`r pander(wilcox.test(total.duration.days.of.all.inpatient.abx ~ study.group, data = abx_distinct_wx))`


#### Length of stay
`r pander(wilcox.test(los.days ~ study.group, data = pt_info_wx))`

